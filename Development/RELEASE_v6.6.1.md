# SixLayer Framework v6.6.1 Release Documentation

**Release Date**: December 19, 2025  
**Release Type**: Patch (SPM Bundle Name Fix)  
**Previous Release**: v6.6.0  
**Status**: ‚úÖ **COMPLETE**

---

## üéØ Release Summary

Patch release fixing Swift Package Manager bundle name issue. This release updates resource bundle access to use `Bundle.module` for Swift Package builds with proper fallback for Xcode framework builds, fixes `CFBundleName` in Info.plist, and enhances the bundle identifier fix script.

---

## üîß Swift Package Manager Bundle Resource Access

### **Bundle.module Support with Conditional Compilation**
- **Swift Package Support**: Updated `InternationalizationService` to use `Bundle.module` for Swift Package builds
- **Conditional Compilation**: Added `#if SWIFT_PACKAGE` to use `Bundle.module` when available
- **Xcode Framework Fallback**: Maintained proper fallback for Xcode framework builds using `Bundle(for:)` approach
- **Location**: `Framework/Sources/Core/Services/InternationalizationService.swift`
- **Impact**: Ensures resources are correctly loaded in both Swift Package and Xcode framework builds

### **CFBundleName Fix**
- **Display Name Correction**: Fixed `CFBundleName` in Info.plist from `SixLayerFramework_SixLayerFramework` to `SixLayerFramework`
- **Proper Bundle Naming**: `CFBundleName` should be the display name, not the bundle path
- **Location**: `Framework/Resources/Info.plist`
- **Impact**: Resolves "bundle format unrecognized" errors when accessing resources

### **Enhanced Bundle Identifier Fix Script**
- **CFBundleName Correction**: Updated `fix_spm_bundle_identifier.sh` to also correct `CFBundleName` if it's set incorrectly
- **Automatic Fix**: Script now fixes both bundle identifier and bundle name during build
- **Location**: `scripts/fix_spm_bundle_identifier.sh`
- **Impact**: Provides automatic fix for SPM-generated bundle naming issues

### **Code Quality Fixes**
- **Return Statement Formatting**: Fixed formatting issue in `DynamicFieldComponents.swift` where `return` was on a separate line
- **Location**: `Framework/Sources/Components/Forms/DynamicFieldComponents.swift`
- **Impact**: Resolves compiler warnings about expression following return

---

## üìù Technical Details

### **Bundle Access Strategy**
The framework now uses a dual-strategy approach for bundle access:

1. **Swift Package Builds**: Uses `Bundle.module` (automatically generated by SPM)
2. **Xcode Framework Builds**: Uses `Bundle(for:)` with resource bundle lookup

This ensures compatibility with both distribution methods.

### **Repository Name Update**
- Repository renamed from `6layer` to `sixlayer` to better match package naming conventions
- Package name remains `SixLayerFramework` in Package.swift
- SPM uses package name for bundle generation, not repository name

---

## üêõ Issues Resolved

- Fixed "bundle format unrecognized, invalid, or unsuitable" error for SPM resource bundles
- Fixed `CFBundleName` being set to bundle path instead of display name
- Fixed `Bundle.module` compilation error in Xcode framework builds
- Fixed return statement formatting warning in DynamicFieldComponents

---

## üìö Documentation Updates

- Added `Framework/docs/BUNDLE_IDENTIFIER_FIX.md` with bundle identifier fix documentation
- Updated bundle identifier fix script with CFBundleName correction
- Enhanced script documentation and usage examples

---

## ‚úÖ Testing

- All unit tests pass on both iOS and macOS
- Bundle resource access verified in both Swift Package and Xcode framework builds
- Bundle identifier fix script tested and verified

---

## üîÑ Migration Notes

No migration required. This is a patch release that fixes bundle access issues without changing any public APIs.

---

## üì¶ Files Changed

- `Framework/Sources/Core/Services/InternationalizationService.swift` - Bundle access with conditional compilation
- `Framework/Resources/Info.plist` - Fixed CFBundleName
- `Framework/Sources/Components/Forms/DynamicFieldComponents.swift` - Return statement formatting
- `scripts/fix_spm_bundle_identifier.sh` - Enhanced to fix CFBundleName
- `Framework/docs/BUNDLE_IDENTIFIER_FIX.md` - New documentation file

---

## üôè Acknowledgments

This release addresses bundle naming issues discovered when using the framework as a Swift Package dependency.

